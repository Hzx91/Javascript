<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>å®šæ—¶å™¨å°è£…ç‰ˆåŠ¨ç”»ç‰¹æ•ˆ</title>
    <!-- å¼•å…¥common.jsæ–‡ä»¶ -->
    <script src="../common.js"></script>
    <style>
        .btn {
            width: 110px;
            height: 30px;
            text-align: center;
            line-height: 30px;
            border-radius: 15px;
            margin-bottom: 50px;
            background-color: #ef76cd;
            cursor: pointer;
        }

        .box {
            width: 150px;
            height: 150px;
            background-color: palegoldenrod;
            text-align: center;
            /* line-height: 150px; */
        }
    </style>
</head>

<body>
    <div class="btn">oiæ¥ç‚¹æˆ‘å‘€~</div>
    <div class="box">å¤©ç”Ÿæˆ‘æå¿…æœ‰ç”¨ğŸ˜</div>
    <script>
        // è·å–æŒ‰é’®å’Œç›’å­å…ƒç´ 
        var btn = document.getElementsByClassName('btn')[0];
        var box = document.getElementsByClassName('box')[0];//æ§åˆ¶å°ä¸ºä»€ä¹ˆè¯´è·å–ä¸åˆ°å…ƒç´ å‘¢ï¼Ÿå› ä¸ºgetElementsByClassNameè·å–çš„æ˜¯ä¸€ä¸ªç±»æ•°ç»„å¯¹è±¡/åˆé›†ï¼Œè¦é€šè¿‡ç´¢å¼•æ¥è·å–å…·ä½“çš„å…ƒç´ â€”â€” document.getElementsByClassName('box')[0];
        // ç»™æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
        btn.addEventListener('click', function () {
            // å½“æŒ‰é’®è¢«ç‚¹å‡»æ—¶ï¼Œè°ƒç”¨animateå‡½æ•°
            // å‚æ•°1ï¼šè¢«ç§»åŠ¨çš„å…ƒç´ ï¼ˆoBox)
            // å‚æ•°2ï¼šåŠ¨ç”»ç»“æŸçš„ä½ç½®ï¼ˆ300pxï¼‰
            // å‚æ•°3ï¼šåŠ¨ç”»æ€»æ—¶é•¿ï¼ˆ500msï¼‰
            animate(oBox, 300, 500);
        }, false);
        // å®šä¹‰animateå‡½æ•°ï¼šè®©oBoxå…ƒç´ äº§ç”Ÿå‘å·¦è¾¹ç§»åŠ¨çš„åŠ¨ç”»æ•ˆæœ
        function animate(ele, end, time) {
            // è®°å½•åŠ¨ç”»å¼€å§‹çš„æ—¶é—´æˆ³(å•ä½ï¼šæ¯«ç§’)
            var startDate = Date.now();//ä¾‹å¦‚ï¼š1720000000000
            // è·å–boxå…ƒç´ å½“å‰çš„leftå€¼ï¼Œå¹¶è½¬æ¢ä¸ºæ•´æ•°
            var currLeft = parseInt(getStyle(ele, 'left'));//getStyle()å‡½æ•°ç”¨äºè·å–å…ƒç´ çš„è®¡ç®—æ ·å¼
            // åœ¨å…ƒç´ ä¸ŠæŒ‚è½½ä¸€ä¸ªå®šæ—¶å™¨IDï¼Œæ–¹ä¾¿åç»­æ¸…é™¤ï¼Œele.timeï¼šå®šæ—¶å™¨çš„IDå·ï¼ˆsetIntervalè¿”å›çš„æ•°å­—ï¼‰
            // setIntervalæ¯éš”ä¸€æ®µæ—¶é—´æ‰§è¡Œä¸€æ¬¡å‡½æ•°
            // 1000/60 â‰ˆ 16.7msï¼Œ60FPSï¼ˆæ¯ç§’60å¸§ï¼‰æ¥è¿‘äºæµè§ˆå™¨æ¯ä¸€å¸§çš„åˆ·æ–°æ—¶é—´ï¼Œè¿™æ˜¯æµç•…åŠ¨ç”»çš„æ ‡å‡†å¸§ç‡
            ele.time = setInterval(function () {
                // è·å–å½“å‰æ—¶é—´çš„æ—¶é—´æˆ³Date.now()
                var nowDate = Date.now();
                // æ—¶é—´ç³»æ•°speedï¼ˆ0~1ï¼‰ï¼šï¼ˆå½“å‰æ—¶é—´-å¼€å§‹æ—¶é—´ï¼‰/æ€»æ—¶é—´ ï¼Œè¡¨ç¤ºåŠ¨ç”»å®Œæˆçš„ç™¾åˆ†æ¯”
                // ä¾‹å¦‚ï¼šåŠ¨ç”»å¼€å§‹16msåï¼Œspeed = 16/500 = 0.032
                speed = (nowDate - startDate) / time;
                //åœ¨æ§åˆ¶å°è¾“å‡ºå½“å‰çš„é€Ÿåº¦ç³»æ•°ï¼Œç”¨äºè°ƒè¯•
                console.log(speed);
                //é‡æ–°è·å–boxå…ƒç´ å½“å‰çš„leftå€¼ï¼ˆå› ä¸ºå¯èƒ½è¢«ä¿®æ”¹è¿‡ï¼‰
                currLeft = parseInt(getStyle(ele, 'left'));
                // åˆ¤æ–­æ¡ä»¶ï¼šå¦‚æœå½“å‰ä½ç½®å·²ç»è¾¾åˆ°æˆ–è¶…è¿‡ç›®æ ‡ä½ç½®
                if (currLeft >= end) {
                    //ç¡®ä¿å…ƒç´ ç²¾ç¡®åœç•™åœ¨ç›®æ ‡ä½ç½®
                    ele.style.left = end + 'px';
                    // æ¸…é™¤å®šæ—¶å™¨ï¼Œåœæ­¢åŠ¨ç”»
                    clearInterval(ele.time);
                    // ç»ˆæ­¢å‡½æ•°æ‰§è¡Œ
                    return false;
                }
                // æ ¸å¿ƒåŠ¨ç”»å…¬å¼ï¼šè®¡ç®—ä¸‹ä¸€å¸§çš„ä½ç½®/æ–°ä½ç½®â†’å½“å‰ä½ç½® + æ—¶é—´ç³»æ•°speed * å‰©ä½™è·ç¦»
                // éšæ—¶é—´æ¨ç§»ï¼Œé€Ÿåº¦ä¼šé€æ¸å‡æ…¢ï¼ˆå‡é€Ÿè¿åŠ¨ï¼‰
                ele.style.left = currLeft + speed * (end - currLeft) + 'px';
            }, 1000 / 60);//æ¯éš”16.7æ¯«ç§’æ‰§è¡Œä¸€æ¬¡
        }

    </script>
</body>

</html>